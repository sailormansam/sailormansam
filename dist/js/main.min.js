var Comic=function(){this.canvas=document.getElementById("comic"),this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.panels=["images/box1.svg","images/box2.svg","images/box3.svg","images/box4.svg"],this.images=[],this.container=document.getElementById("alone"),this.create()};Comic.prototype={create:function(){this.resize()},drawPanels:function(t){var i=0;this.loadedCounter=0,this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);for(var e=0,s=this.panels.length/2;s>e;e++)for(var n=0,s=this.panels.length/2;s>n;n++){var a=new Image;a.src=this.panels[i],t?this.imageLoader(this.canvas,this.ctx,a,0,i*this.canvas.height/4,this.canvas.width,this.canvas.width):this.imageLoader(this.canvas,this.ctx,a,n*this.canvas.width/2,e*this.canvas.height/2,this.canvas.width/2,this.canvas.width/2),this.images.push(a),i++}},resize:function(){this.container.clientWidth<672?(this.canvas.width=this.container.clientWidth,this.canvas.height=4*this.container.clientWidth,this.drawPanels(!0)):(this.canvas.width=672,this.canvas.height=672,this.drawPanels())},imageLoader:function(t,i,e,s,n,a,c){var h=this.container;e.onload=function(){i.drawImage(e,s,n,a,c);var o=t.toDataURL();document.getElementById("renderedComic").src=o,document.getElementById("renderedComic").style.display="block",h.style.paddingTop=0}}},function(){var t=angular.module("comic",[]);t.controller("PanelController",function(t){var i=this;t.get("/data.json").success(function(t){i.comics=t.panels}).error(function(){console.log("error")})}),t.directive("endDirective",function(t,i){return function(e,s,n){if(e.$last){var a=window.location.hash;t.hash(a.substr(2,a.length)),i()}}})}(),function(){window.onscroll=function(){for(var t,i=document.getElementsByTagName("article"),e="",s=0,n=i.length;n>s;s++)document.body.scrollTop>=i[s].offsetTop&&(t=i[s],e=i[s].id);history.replaceState(null,null,"#"+e)}}();